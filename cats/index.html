<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Purrfect Training ‚Äî Science-Based Cat Training</title>
  <meta name="description" content="Free, science-based cat training guides using positive reinforcement. Litter, scratching, carrier, harness/leash, clicker, enrichment, introductions, and more." />
  <meta name="theme-color" content="#7c3aed" />
  <style>
    /* ===== Base / Theme ===== */
    :root{
      --bg:#0b1020; --panel:#0f172a; --card:#141c33; --ink:#e5e7eb; --muted:#9aa3b2;
      --acc:#a78bfa; --acc2:#ec4899; --ok:#22c55e; --warn:#f59e0b; --err:#ef4444; --link:#60a5fa;
      --tab:#1b2746; --chip:#1e293b;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,sans-serif;color:#111;background:linear-gradient(135deg,#7c3aed 0%,#4c1d95 100%)}

    .container{max-width:1200px;margin:0 auto;padding:0 20px}

    /* Page visibility */
    .page{display:none}
    .page.active{display:block}

    /* Header / Nav */
    header{background:rgba(255,255,255,.96);backdrop-filter:blur(10px);padding:14px 0;position:fixed;top:0;left:0;right:0;z-index:1000;box-shadow:0 2px 20px rgba(0,0,0,.12)}
    nav{display:flex;justify-content:space-between;align-items:center}
    .logo{font-weight:800;font-size:1.6rem;color:#4a5568;display:flex;gap:10px;align-items:center;cursor:pointer}
    .logo::before{content:"üêà";font-size:1.9rem}
    .nav-links{display:flex;list-style:none;gap:1.5rem}
    .nav-links a{cursor:pointer;text-decoration:none;color:#374151;font-weight:600}
    .nav-links a:hover{color:#7c3aed}
    .unlock-chip{background:#ec4899;color:#fff;padding:.35rem .7rem;border-radius:999px}

    /* Hero */
    .hero{margin-top:80px;padding:60px 0;text-align:center;color:#fff}
    .hero h1{font-size:3rem;margin-bottom:.6rem;background:linear-gradient(45deg,#fff,#fde68a);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .hero p{opacity:.95;font-size:1.15rem}
    .cta{display:inline-block;margin-top:16px;background:linear-gradient(45deg,#ec4899,#fb7185);color:#fff;padding:14px 22px;border-radius:999px;font-weight:800;box-shadow:0 8px 24px rgba(236,72,153,.45);border:0;cursor:pointer}
    .cta:hover{transform:translateY(-1px)}

    /* Sections */
    .section{background:#fff;padding:64px 0}
    .section h2{text-align:center;font-size:2.2rem;margin-bottom:28px;color:#1f2937}

    .grid{display:grid;gap:20px}
    .features-grid {
	  display: grid;
	  grid-template-columns: repeat(3, 1fr); /* always 3 across */
	  gap: 20px;
	  justify-items: stretch;
	}

	@media (max-width: 900px) {
	  .features-grid {
		grid-template-columns: repeat(2, 1fr); /* 2 columns on tablets */
	  }
	}

	@media (max-width: 600px) {
	  .features-grid {
		grid-template-columns: 1fr; /* single column on phones */
	  }
	}
    .feature{background:linear-gradient(135deg,#f7fafc,#eef2ff);border:1px solid rgba(124,58,237,.15);padding:22px;border-radius:14px;text-align:center;transition:.2s}
    .feature:hover{transform:translateY(-4px);box-shadow:0 10px 26px rgba(0,0,0,.08)}
    .feature .ico{font-size:2rem;margin-bottom:8px}
    .feature h3{color:#111827;margin:6px 0 4px}
    .feature p{color:#334155;font-size:.98rem}

    /* Area cards */
    .areas{background:linear-gradient(135deg,#7c3aed,#4c1d95);color:#fff}
    .areas .grid{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    .card{background:rgba(255,255,255,.12);border:2px solid rgba(255,255,255,.25);backdrop-filter:blur(6px);padding:18px;border-radius:14px;cursor:pointer;position:relative;transition:.2s}
    .card:hover{transform:translateY(-3px);background:rgba(255,255,255,.18)}
    .card h4{font-size:1.1rem;margin-bottom:6px}
    .card p{font-size:.92rem;opacity:.92}
    .card::after{content:"Start ‚Üí";position:absolute;right:12px;bottom:10px;font-size:.8rem;opacity:.75}
    .card.locked{border-style:dashed;border-color:#fda4af;background:rgba(255,255,255,.08);cursor:not-allowed}
    .card.locked::after{content:"üîí Premium"}

    /* Training page / steps */
    .training{background:#fff;min-height:100vh;padding:90px 0 56px}
    .back{background:#7c3aed;color:#fff;border:0;border-radius:10px;padding:10px 14px;cursor:pointer;margin-bottom:18px}
    .t-head{text-align:center;margin-bottom:26px}
    .t-head h1{font-size:2.2rem;color:#111827;margin-bottom:6px}
    .t-head p{color:#475569}
    .steps{background:#f8fafc;border-radius:14px;padding:18px;margin:16px 0}
    .step{background:#fff;border-left:4px solid #7c3aed;border-radius:10px;padding:14px;margin:12px 0;box-shadow:0 2px 10px rgba(0,0,0,.06)}
    .step .n{background:#7c3aed;color:#fff;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;font-weight:800;margin-right:8px}

    .tips{background:linear-gradient(135deg,#ecfeff,#fdf2f8);border:1px solid #99f6e4;border-radius:14px;padding:16px;margin:18px 0}
    .warn{background:linear-gradient(135deg,#fff7ed,#fef9c3);border:1px solid #fbbf24;border-radius:14px;padding:16px;margin:18px 0}

    /* Modal (unlock + tracker) */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:2000}
    .modal .panel{background:#111827;color:#fff;border:2px solid #7c3aed;border-radius:14px;max-width:640px;width:92vw;margin:8% auto;padding:20px;position:relative;box-shadow:0 16px 40px rgba(0,0,0,.45)}
    
    .panel h2{color:#c4b5fd;margin-bottom:10px}
    .panel input[type=text]{width:100%;padding:12px;border-radius:10px;border:1px solid #7c3aed;background:#1f2937;color:#fff;text-align:center;letter-spacing:2px}
    
	/* Close button ‚Äî scoped and circular */
	.panel .close{
	  position:absolute;top:10px;right:12px;
	  display:inline-flex;align-items:center;justify-content:center;
	  width:32px;height:32px;line-height:1;
	  border-radius:999px;
	  border:1px solid rgba(255,255,255,.25);
	  background:rgba(255,255,255,.10);
	  color:#fff;cursor:pointer
	}
	.panel .close:hover{ background:rgba(255,255,255,.18) }

	/* Full-width action buttons ‚Äî exclude the close */
	.panel button:not(.close){
	  margin-top:10px;width:100%;padding:11px;border-radius:10px;
	  border:0;cursor:pointer;background:#7c3aed;color:#fff
	}
	.panel .ghost{ background:#374151;border:1px solid #7c3aed }    

    /* Footer */
    footer{background:#111827;color:#e5e7eb;text-align:center;padding:26px 0}

	/* === CAT TRAINING LIST === */
	#training-list .grid {
	  display: grid;
	  grid-template-columns: repeat(3, minmax(260px, 1fr));
	  gap: 24px;
	  margin-top: 2rem;
	}

	#training-list .card {
	  background: #fff;
	  border: 1px solid rgba(0,0,0,0.08);
	  border-radius: 16px;
	  box-shadow: 0 4px 14px rgba(0,0,0,0.06);
	  padding: 24px;
	  height: 180px;                /* MATCH DOG SITE HEIGHT */
	  display: flex;
	  flex-direction: column;
	  justify-content: center;
	  transition: transform 0.2s, box-shadow 0.2s;
	}
	#training-list .card:hover {
	  transform: translateY(-4px);
	  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
	}
	#training-list .card h4 {
	  font-weight: 700;
	  font-size: 1.1rem;
	  margin-bottom: 0.5rem;
	}
	#training-list .card p {
	  color: #374151;
	  font-size: 0.95rem;
	}

	/* Responsive to match dog site */
	@media (max-width: 900px){
	  #training-list .grid{ grid-template-columns: repeat(2, minmax(220px,1fr)); }
	}
	@media (max-width: 600px){
	  #training-list .grid{ grid-template-columns: 1fr; }
	}

    /* Responsive */
    @media (max-width:768px){
      .nav-links{display:none}
      .hero h1{font-size:2.2rem}
      .panel{margin:15% auto}
    }
  </style>
</head>
<body>
  <header>
    <nav class="container">
      <div class="logo" onclick="showPage('home')">Purrfect Training</div>
      <ul class="nav-links">
        <li><a onclick="showPage('home')">Home</a></li>
        <li><a onclick="showPage('training-list')">Training Areas</a></li>
        <li><a onclick="showPage('about')">About</a></li>
        <li><a onclick="showPage('resources')">Resources</a></li>
        <li><a onclick="showPage('contact')">Contact</a></li>
		<li><a href="/">üêï Dog Training</a></li>
        <li><a class="unlock-chip" onclick="openUnlock()">üîì UNLOCK</a></li>
      </ul>
    </nav>
  </header>

  <!-- HOME -->
  <main id="home" class="page active">
    <section class="hero">
      <div class="container">
        <h1>Science-Based Cat Training</h1>
        <p>Positive reinforcement, clicker games, fear-free husbandry, and smart environment design for happier cats.</p>
        <button class="cta" onclick="showPage('training-list')">Start Training</button>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <h2>Why Train Cats?</h2>
        <div class="grid features-grid">
          <div class="feature">
            <div class="ico">üß†</div>
            <h3>Proven Learning</h3>
            <p>Cats can learn quickly with rewards and marker signals (e.g., clicker). Shelters report better engagement and exploratory behavior after training.</p>
          </div>
          <div class="feature">
            <div class="ico">üò∫</div>
            <h3>Stress Less</h3>
            <p>Carrier and handling training reduce fear at the vet and during transport via desensitization and counter-conditioning.</p>
          </div>
          <div class="feature">
            <div class="ico">üè†</div>
            <h3>Better Living</h3>
            <p>Right litter setup, scratching outlets, and enrichment prevent common issues and improve welfare.</p>
          </div>
          <div class="feature">
            <div class="ico">ü§ù</div>
            <h3>Stronger Bond</h3>
            <p>Reward-based methods build trust without aversives. Great for kittens and adults alike.</p>
          </div>
        </div>
      </div>
    </section>

	<!-- TEMPLATE TRAINING PAGE (rendered dynamically) -->
	<section id="training" class="page training">
	  <div class="container">
		<button class="back" onclick="showPage('training-list')">‚Üê Back to Training Areas</button>
		<div class="t-head">
		  <h1 id="t-title">Topic</h1>
		  <p id="t-sub">Summary</p>
		</div>
		<div class="center" style="text-align:center;margin:10px 0 16px">
		  <button class="cta" onclick="openTracker()">üìä Track My Progress</button>
		</div>
		<div class="steps" id="t-steps"></div>
		<div class="tips" id="t-tips"></div>
		<div class="warn" id="t-warn"></div>
	  </div>
	</section>
	
  </main>

  <!-- LIST -->
  <section id="training-list" class="page training">
    <div class="container">
      <button class="back" onclick="showPage('home')">‚Üê Back to Home</button>
      <div class="t-head">
        <h1>Training Areas</h1>
        <p>Choose a topic to get a step-by-step plan with progress tracking.</p>
      </div>
      <div class="grid">
        <div class="card" onclick="showTraining('litter')"><h4>üß∫ Litter Habits</h4><p>Box size, number, substrate, location</p></div>
        <div class="card" onclick="showTraining('scratching')"><h4>ü™µ Scratching</h4><p>Post types, placement, reinforcement</p></div>
        <div class="card" onclick="showTraining('carrier')"><h4>üß≥ Carrier/Handling</h4><p>Desensitization steps</p></div>
        <div class="card" onclick="showTraining('harness')"><h4>ü™¢ Harness & Leash</h4><p>Indoor ‚Üí yard ‚Üí quiet routes</p></div>
        <div class="card" onclick="showTraining('clicker')"><h4>üîä Clicker Basics</h4><p>Charge the marker, shape skills</p></div>
        <div class="card" onclick="showTraining('intro')"><h4>üêà‚Äç‚¨õ Introductions</h4><p>Scent swap, gates, gradients</p></div>
        <div class="card locked" data-premium="1" onclick="guardPremium(event)"><h4>üçΩÔ∏è Husbandry</h4><p>Meds, brush, teeth, trim</p></div>
        <div class="card locked" data-premium="1" onclick="guardPremium(event)"><h4>üéØ Target & Recall</h4><p>Target stick, station, come</p></div>
        <div class="card locked" data-premium="1" onclick="guardPremium(event)"><h4>üòø Fear & Aggression</h4><p>CC/DS below threshold</p></div>
      </div>
    </div>
  </section>

  <!-- ABOUT -->
  <section id="about" class="page training">
    <div class="container">
      <button class="back" onclick="showPage('home')">‚Üê Back to Home</button>
      <div class="t-head">
        <h1>About This Approach</h1>
        <p>Reward-based training, environmental design, and fear-free handling help cats learn while staying calm and confident.</p>
      </div>
      <div class="steps">
        <div class="step"><h3><span class="n">1</span>Positive Reinforcement</h3><p>Increase wanted behavior by immediately rewarding it. Marker signals (click/‚Äúyes‚Äù) can improve timing.</p></div>
        <div class="step"><h3><span class="n">2</span>Desensitization & Counter-Conditioning</h3><p>Expose at levels where your cat remains relaxed (‚Äúbelow threshold‚Äù) and pair with great outcomes. Advance gradually.</p></div>
        <div class="step"><h3><span class="n">3</span>Environment & Needs</h3><p>Provide the right number/size of litter boxes, vertical space, resting spots, play, and multiple scratching options.</p></div>
      </div>
    </div>
  </section>

  <!-- RESOURCES -->
  <section id="resources" class="page training">
    <div class="container">
      <button class="back" onclick="showPage('home')">‚Üê Back to Home</button>
      <div class="t-head">
        <h1>Training Resources</h1>
        <p>Recommended books, equipment, and organizations that support reward-based feline training and welfare.</p>
      </div>
  
      <div class="grid features-grid">
        <!-- Essential Reading -->
        <div class="feature">
          <div class="ico">üìö</div>
          <h3>Essential Reading</h3>
          <p>
            <strong>"Decoding Your Cat"</strong> ‚Äî ACVB<br>
            <strong>"Think Like a Cat"</strong> ‚Äî Pam Johnson-Bennett<br>
            <strong>"Total Cat Mojo"</strong> ‚Äî Jackson Galaxy
          </p>
        </div>
  
        <!-- Professional Organizations -->
        <div class="feature">
          <div class="ico">üèõÔ∏è</div>
          <h3>Professional Organizations</h3>
          <p>
            <strong>AAFP</strong> ‚Äî American Assoc. of Feline Practitioners<br>
            <strong>ISFM</strong> ‚Äî Intl. Society of Feline Medicine<br>
            <strong>IAABC</strong> ‚Äî Intl. Assoc. of Animal Behavior Consultants<br>
            <strong>AVSAB</strong> ‚Äî Vet Society of Animal Behavior
          </p>
        </div>
  
        <!-- Training Equipment -->
        <div class="feature">
          <div class="ico">üõ†Ô∏è</div>
          <h3>Training Equipment</h3>
          <p>
            <strong>Clicker/marker:</strong> precise timing<br>
            <strong>Harness:</strong> H/Y-style cat harness (never collar)<br>
            <strong>Treats:</strong> tiny, soft, high-value; lickable tubes<br>
            <strong>Target stick & mat:</strong> for follow/station work<br>
            <strong>Puzzle feeders:</strong> for enrichment/foraging
          </p>
        </div>
  
        <!-- Learning Theory -->
        <div class="feature">
          <div class="ico">üß†</div>
          <h3>Learning Theory</h3>
          <p>
            Positive reinforcement increases behavior.<br>
            Negative punishment (withholding access) reduces unwanted behavior without fear.<br>
            Train <em>below threshold</em>; keep sessions short, fun, and consistent.
          </p>
        </div>
  
        <!-- Avoid These Methods -->
        <div class="feature">
          <div class="ico">‚ö†Ô∏è</div>
          <h3>Avoid These Methods</h3>
          <p>
            Scruffing, spray bottles, yelling, or physical corrections.<br>
            Dominance/‚Äúalpha‚Äù theories, aversive collars, forced handling.<br>
            Punishment risks fear, hiding, and aggression.
          </p>
        </div>
  
        <!-- Scientific Guidelines (Cats) -->
        <div class="feature">
          <div class="ico">üî¨</div>
          <h3>Scientific Guidelines</h3>
          <p>
            <strong>AAHA/AAFP Life Stage (2021):</strong> preventive behavior & environment by age.<br>
            <strong>AAFP/ISFM Env. Needs (2020):</strong> 5 pillars‚Äîresources, safety, scent, play, and routine.<br>
            <strong>Clicker studies:</strong> shelter/home research shows faster learning & more affiliative behavior.
          </p>
        </div>
      </div>
    </div>
  </section>


  <!-- CONTACT -->
  <section id="contact" class="page training">
    <div class="container">
      <button class="back" onclick="goCatHome(event)">‚Üê Back to Home</button>
      <div class="t-head">
        <h1>Website Support</h1>
        <p>Report issues or suggest improvements for this free educational site.</p>
      </div>
      <div class="steps">
        <div class="step">
          <h3>Send Feedback</h3>
          <form id="feedbackForm" onsubmit="handleFeedback(event)">
            <label>Message<br><textarea id="fb-msg" required style="width:100%;height:110px;border:1px solid #7c3aed;border-radius:10px;padding:10px"></textarea></label>
            <button class="cta" style="margin-top:10px">Submit</button>
          </form>
          <p id="fb-status" style="margin-top:8px;color:#7c3aed;font-weight:700"></p>
        </div>
        <div class="warn">
          <h3>Important</h3>
          <p>This site is educational only. For serious behavior issues, consult a qualified feline behavior professional or your veterinarian.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Unlock Modal -->
  <div id="unlock-modal" class="modal" role="dialog" aria-modal="true">
    <div class="panel">
      <button class="close" onclick="closeUnlock()">‚úï</button>
      <h2>Unlock Premium Topics</h2>
      <p style="opacity:.9;margin-bottom:10px">Enter a 6-character code to unlock Husbandry, Target/Recall, and Fear/Aggression.</p>
      <input id="unlock-code" type="text" maxlength="6" placeholder="ABC123" />
      <button onclick="applyUnlock()">Unlock</button>
      <button class="ghost" onclick="generateDemoCode()">Get Free Code</button>
	  <button class="ghost" onclick="openDonation()">‚ù§Ô∏è Support Development</button>
    </div>
  </div>

  <!-- Progress Tracker Modal -->
  <div id="tracker-modal" class="modal" role="dialog" aria-modal="true">
    <div class="panel" id="tracker-panel">
      <button class="close" onclick="closeTracker()">‚úï</button>
      <h2 id="trk-title">Progress Tracker</h2>
      <div id="trk-list"></div>
      <button class="ghost" onclick="clearTracker()">Clear This Topic</button>
    </div>
  </div>

  <footer>
    <div class="container">
      <p>&copy; 2025 Purrfect Training ‚Äî Reward-based feline education.</p>
      <p>Zero force ‚Ä¢ Fear-reduction ‚Ä¢ Welfare-first</p>
    </div>
  </footer>

  <script>
    /* ========= Router ========= */
    function showPage(id){
      for(const el of document.querySelectorAll('.page')) el.classList.remove('active');
      document.getElementById(id).classList.add('active');
      window.scrollTo({top:0,behavior:'instant'});
    }

	function openDonation(){
	  window.open('https://paypal.me/ReverendDrTolerant?country.x=US&locale.x=en_US','_blank','noopener');
	}

    function showTraining(id){
      const t = TRAINING[id];
      if(!t){alert('Missing topic');return;}
      // Render header
      document.getElementById('t-title').textContent = t.title;
      document.getElementById('t-sub').textContent   = t.subtitle;
      // Render steps
      const stepsEl = document.getElementById('t-steps'); stepsEl.innerHTML = '<h2>Step-by-Step Plan</h2>';
      t.steps.forEach((s,i)=>{
        const div = document.createElement('div');
        div.className='step';
        div.innerHTML = `<h3><span class="n">${i+1}</span>${s.h}</h3><p>${s.p}</p>`;
        stepsEl.appendChild(div);
      });
      // Tips + warnings
      document.getElementById('t-tips').innerHTML = `<h3>üí° Tips</h3><ul style="padding-left:18px">${t.tips.map(x=>`<li>${x}</li>`).join('')}</ul>`;
      document.getElementById('t-warn').innerHTML = `<h3>üîß Troubleshooting</h3><ul style="padding-left:18px">${t.warn.map(x=>`<li>${x}</li>`).join('')}</ul>`;
      // Set current topic for tracker
      CURRENT_TOPIC = id;
      showPage('training');
    }

    /* ========= Premium Guard (separate key from dog site) ========= */
    const STORAGE_KEY_UNLOCK = 'feline_training_unlock_v1'; // unique key so sites don't cross-unlock
    function isUnlocked(){ return localStorage.getItem(STORAGE_KEY_UNLOCK) === '1'; }
    function guardPremium(e){
      if(!isUnlocked()){ e.preventDefault(); openUnlock(); }
    }
    function openUnlock(){ document.getElementById('unlock-modal').style.display='block'; }
    function closeUnlock(){ document.getElementById('unlock-modal').style.display='none'; }
    function applyUnlock(){
      const v = (document.getElementById('unlock-code').value || '').trim().toUpperCase();
      if(v.length!==6){ alert('Enter a 6-character code.'); return; }
      // Simple accept for demo; replace with server verification if desired
      localStorage.setItem(STORAGE_KEY_UNLOCK,'1');
      closeUnlock();
      alert('Premium topics unlocked on the cat site only.');
    }
    function generateDemoCode(){
      const code = Math.random().toString(36).slice(2,8).toUpperCase();
      document.getElementById('unlock-code').value = code;
    }

    /* ========= Progress Tracker ========= */
    let CURRENT_TOPIC = null;
    function trackerKey(){ return 'feline_tracker_'+CURRENT_TOPIC; }
    function openTracker(){
      if(!CURRENT_TOPIC){ alert('Open a training topic first.'); return; }
      document.getElementById('trk-title').textContent = 'Progress ‚Äî ' + TRAINING[CURRENT_TOPIC].title;
      renderTracker();
      document.getElementById('tracker-modal').style.display='block';
    }
    function closeTracker(){ document.getElementById('tracker-modal').style.display='none'; }
    function renderTracker(){
      const k = trackerKey();
      const data = JSON.parse(localStorage.getItem(k) || '[]'); // array of stars per step
      const steps = TRAINING[CURRENT_TOPIC].steps;
      const host = document.getElementById('trk-list');
      host.innerHTML = '';
      steps.forEach((s,idx)=>{
        const row = document.createElement('div');
        row.style.cssText = 'background:#fff;color:#111;border-left:4px solid #7c3aed;border-radius:10px;padding:12px;margin:10px 0';
        const stars = (data[idx]||0);
        row.innerHTML =
          `<div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
            <div><strong>Step ${idx+1}:</strong> ${s.h}</div>
            <div>${renderStars(stars,idx)}</div>
          </div>`;
        host.appendChild(row);
      });
    }
    function renderStars(active, idx){
      let out='';
      for(let i=1;i<=5;i++){
        const isOn = i<=active;
        out += `<span data-i="${i}" data-step="${idx}" class="star" style="font-size:28px;cursor:pointer;color:${isOn?'#fbbf24':'#e5e7eb'}">‚òÖ</span>`;
      }
      return out;
    }
    document.addEventListener('click', (e)=>{
      if(e.target.classList.contains('star')){
        const i = +e.target.getAttribute('data-i');
        const s = +e.target.getAttribute('data-step');
        const k = trackerKey();
        const data = JSON.parse(localStorage.getItem(k) || '[]');
        data[s]=i; localStorage.setItem(k, JSON.stringify(data));
        renderTracker();
      }
      if(e.target.classList.contains('modal')) e.target.style.display='none';
    });
    function clearTracker(){
      localStorage.removeItem(trackerKey());
      renderTracker();
    }

    /* ========= Feedback (client-side only demo) ========= */
    function handleFeedback(ev){
      ev.preventDefault();
      const msg = (document.getElementById('fb-msg').value||'').trim();
      if(!msg){return;}
      // In production, POST to your endpoint. Here we persist locally for user review.
      const k='feline_feedback_store';
      const arr = JSON.parse(localStorage.getItem(k)||'[]');
      arr.push({t:Date.now(),msg});
      localStorage.setItem(k,JSON.stringify(arr));
      document.getElementById('fb-msg').value='';
      document.getElementById('fb-status').textContent='Thanks! Your feedback was saved locally.';
      setTimeout(()=>document.getElementById('fb-status').textContent='',3000);
    }

    /* ========= Training Content (no placeholders) ========= */
    const TRAINING = {
      litter:{
        title:'üß∫ Litter Habits',
        subtitle:'Set up boxes your cat wants to use; fix issues without punishment.',
        steps:[
          {h:'Provide Enough, Proper Boxes', p:'One box per cat + one extra. Size: at least 1.5√ó body length (large storage-tote style works). Low/unguarded entry for kittens/seniors.'},
          {h:'Choose Unscented, Fine Substrate', p:'Most cats prefer soft, unscented, clumping litter. Avoid strong perfumes.'},
          {h:'Place Boxes Right', p:'Quiet, separate locations away from food/water, easy access on every floor. Avoid corners with no escape path.'},
          {h:'Cleanliness & Depth', p:'Scoop at least 1‚Äì2√ó daily; maintain ~2‚Äì3 inches depth; wash box with mild soap weekly.'},
          {h:'Fix Problems Systematically', p:'Rule out medical causes with a vet. Add boxes and change one variable at a time. Reinforce correct use; never punish accidents.'}
        ],
        tips:['Add night-light for dark hallways','Use high-sided box for kickers; low entry for mobility needs','Place a temporary box where accidents occur, then gradually move'],
        warn:['If spraying or painful elimination is seen, contact your vet promptly','Stress or inter-cat conflict often underlies issues‚Äîadd resources and vertical space']
      },
      scratching:{
        title:'ü™µ Scratching & Posts',
        subtitle:'Give legal outlets and make them the best choice.',
        steps:[
          {h:'Offer Multiple Textures & Angles', p:'Sisal fabric/rope, cardboard, and wood; both vertical towers and horizontal pads.'},
          {h:'Place Where Cat Wants', p:'Near sleep spots, windows, and prior ‚Äúillegal‚Äù areas. Anchor posts so they do not wobble.'},
          {h:"Make The Post 'Pay'", p:'Lure with wand play; mark with catnip or silver vine; jackpot reward when used.'},
          {h:'Block & Redirect', p:'Cover previously scratched furniture with temporary guards or double-sided tape while reinforcing the post.'}
        ],
        tips:['Tall posts (‚â• 30 in / 75 cm) for full stretch','Reward every approach/use for the first week'],
        warn:['Do not punish scratching; provide alternatives and reinforce them']
      },
      carrier:{
        title:'üß≥ Carrier/Handling',
        subtitle:'Teach the carrier = treats & naps so vet trips are easier.',
        steps:[
          {h:'Carrier Stays Out', p:'Leave it open with a soft blanket in a normal hangout area.'},
          {h:'Feed & Treat In Carrier', p:'Drop treats inside; feed meals nearby ‚Üí just inside ‚Üí fully inside.'},
          {h:'Close Briefly, Release Calmly', p:'Close door for 1‚Äì2 seconds while feeding, then open. Build duration slowly.'},
          {h:'Pick Up & Move', p:'Lift carrier a few inches, treat; later walk around the room; then short car idles ‚Üí minute drives.'},
          {h:'Add Gentle Handling', p:'Pair touch (paws, ears) with treats to prepare for exams and nail trims.'}
        ],
        tips:['Top-opening carrier helps handling','Use a familiar towel sprayed lightly with species-safe pheromone 10‚Äì15 min before use'],
        warn:['Train below fear threshold; if panting, drooling, or hiding increases, back up a step']
      },
      harness:{
        title:'ü™¢ Harness & Leash',
        subtitle:'Indoor practice ‚Üí quiet yard ‚Üí calm, short routes.',
        steps:[
          {h:'Fit A Cat-Specific Harness', p:'Y-front or H-style; never clip a leash to a collar.'},
          {h:'Pair Harness With Rewards', p:'Harness on = treats/play; off = no treats. Increase wear time gradually.'},
          {h:'Leash Drag Indoors', p:'Let the leash drag while you reward following and check-ins.'},
          {h:'Doorway & Yard Sessions', p:'Practice at threshold; then brief yard time; retreat before stress appears.'},
          {h:'Explore Quietly', p:'Follow the cat‚Äôs pace; avoid dogs/traffic; end on a win.'}
        ],
        tips:['Use a long line only in secure areas','Carry a towel to scoop and retreat if startled'],
        warn:['If your cat flattens/freezes, go back several steps; never force movement']
      },
      clicker:{
        title:'üîä Clicker Basics',
        subtitle:'Marker training speeds communication and turns learning into play.',
        steps:[
          {h:'Charge The Marker', p:'Click ‚Üí treat, 10‚Äì15 times. The click predicts food.'},
          {h:'Target Game', p:'Present a target (spoon/stick). Click the instant the nose touches; then treat.'},
          {h:'Lure ‚Üí Fade', p:'Lure sit with a treat, then click/treat; quickly fade the lure to a hand cue.'},
          {h:'Shape Micro-Steps', p:'Reinforce small moves toward the goal (e.g., stepping into carrier).'},
          {h:'Short, Fun Sessions', p:'30‚Äì60 seconds, a few times daily; stop while your cat is eager.'}
        ],
        tips:['Use tiny, high-value treats','One behavior per short session'],
        warn:['If arousal rises or cat walks away, end session and reduce criteria']
      },
      intro:{
        title:'üêà‚Äç‚¨õ Introductions',
        subtitle:'Slow scent work and controlled visuals prevent conflict.',
        steps:[
          {h:'Room Separation', p:'New cat gets a private room with resources; feed both cats on opposite sides of door.'},
          {h:'Scent Swaps & Site Swaps', p:'Exchange bedding; briefly swap rooms so each explores safely.'},
          {h:'Visual Glimpses', p:'Gate or cracked door with treats for calm looking; sessions stay short.'},
          {h:'Parallel Play/Feeding', p:'Increase shared time while playing/feeding with distance.'},
          {h:'Short Supervised Access', p:'Allow brief together time; interrupt tension early; progress gradually.'}
        ],
        tips:['Add vertical space and multiple resources in common areas'],
        warn:['Hissing/growling ‚Üí step back to the last calm stage; never force contact']
      },
      // Premium examples (unlocked with code)
      husbandry:{
        title:'üçΩÔ∏è Husbandry Skills',
        subtitle:'Brush, medicate, and trim with cooperative care.',
        steps:[
          {h:'Consent Cues', p:'Teach a station mat; start all sessions on the mat; reinforce staying.'},
          {h:'Touch ‚Üí Treat', p:'Pair brief touches (ears/paws/mouth) with treats; increase duration slowly.'},
          {h:'Tools Desensitization', p:'Show brush/clipper ‚Üí treat; touch lightly ‚Üí treat; single nail ‚Üí treat.'},
          {h:'Micro-Goals', p:'One tiny rep per area; stop before frustration.'}
        ],
        tips:['Warm towels relax muscles before nail trims'],
        warn:['If struggling, pause; two-person restraint is a last resort and can backfire']
      },
      target:{
        title:'üéØ Target & Recall',
        subtitle:'Teach follow, station, and ‚Äúcome.‚Äù',
        steps:[
          {h:'Nose Target', p:'Click/treat nose to target; move target a few inches at a time.'},
          {h:'Follow The Target', p:'Guide to carrier/post/room; reinforce frequently.'},
          {h:'Station', p:'Reward going to a mat or perch; add duration.'},
          {h:'Recall', p:'Cheerful cue from a short distance ‚Üí jackpot; increase distance and distractions indoors first.'}
        ],
        tips:['Never call to end fun (like nail trims) while training recall'],
        warn:['Use indoors or on a secure long line until reliable']
      },
      fear:{
        title:'üòø Fear & Aggression',
        subtitle:'Work well below threshold; pair triggers with great outcomes.',
        steps:[
          {h:'Identify Triggers', p:'Note distance/sound that starts tension; that is your starting point.'},
          {h:'CC/DS Plan', p:'Trigger at low intensity ‚Üí treat sequence; end before tension rises.'},
          {h:'Body Language', p:'Ears back, tail tucked, dilated pupils = too much; decrease intensity.'},
          {h:'Safety', p:'Avoid reaching, cornering, or punishment; create escape routes.'}
        ],
        tips:['Short sessions, higher value rewards, generous rest days'],
        warn:['Seek professional help for bites or escalating aggression']
      }
    };

    /* ========= Gate for premium navigation ========= */
    function showTrainingPage(id){
      const premium = ['husbandry','target','fear'];
      if(premium.includes(id) && !isUnlocked()){ openUnlock(); return; }
      showTraining(id);
    }

    /* ========= Init ========= */
    // Ensure locked cards become clickable after unlock without reload
    window.addEventListener('storage', (e)=>{
      if(e.key===STORAGE_KEY_UNLOCK && e.newValue==='1'){
        for(const c of document.querySelectorAll('.card.locked')) c.classList.remove('locked');
      }
    });
  </script>
  <script>
  function updateCatUnlockButton() {
    var btn = document.querySelector('.unlock-chip');
    if (!btn) return;
    if (localStorage.getItem('feline_training_unlock_v1') === '1') {
      btn.textContent = '‚úÖ Registered';
      btn.style.background = '#22c55e';
      btn.style.color = '#fff';
    } else {
      btn.textContent = 'üîì UNLOCK';
      btn.style.background = '#ec4899';
      btn.style.color = '#fff';
    }
  }
  
  document.addEventListener('DOMContentLoaded', updateCatUnlockButton);
  
  /* Patch applyUnlock to update UI immediately, without changing your original name */
  (function(){
    var origApply = window.applyUnlock;
    window.applyUnlock = function () {
      if (typeof origApply === 'function') origApply();
      updateCatUnlockButton();
    };
  })();
  </script> 
  <script>
    // Always keep "Back to Home" inside the cat site
    function goCatHome(e){
      if (e) e.preventDefault();
      // If we're not already under /cats/, hard-redirect to the cat home
      if (!/\/cats(\/|$)/i.test(location.pathname)) {
        location.href = '/cats/index.html';
        return;
      }
      // SPA-style: just show the home page section
      showPage('home');
      // (Optional) normalize the URL if someone deep-linked a cat subpage
      if (!/\/cats\/index\.html$/i.test(location.pathname)) {
        history.replaceState(null, '', '/cats/index.html');
      }
    }
  </script>  
</body>
</html>
